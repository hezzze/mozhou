"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[319],{64317:function(z,E,e){var a=e(1413),n=e(91),u=e(85893),f=e(22270),d=e(67294),m=e(66758),C=e(54425),D=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],v=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],t=d.forwardRef(function(r,T){var j=r.fieldProps,i=r.children,A=r.params,P=r.proFieldProps,c=r.mode,Z=r.valueEnum,S=r.request,M=r.showSearch,s=r.options,p=(0,n.Z)(r,D),x=(0,d.useContext)(m.Z);return(0,u.jsx)(C.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,f.h)(Z),request:S,params:A,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({options:s,mode:c,showSearch:M,getPopupContainer:x.getPopupContainer},j),ref:T,proFieldProps:P},p),{},{children:i}))}),l=d.forwardRef(function(r,T){var j=r.fieldProps,i=r.children,A=r.params,P=r.proFieldProps,c=r.mode,Z=r.valueEnum,S=r.request,M=r.options,s=(0,n.Z)(r,v),p=(0,a.Z)({options:M,mode:c||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label"},j),x=(0,d.useContext)(m.Z);return(0,u.jsx)(C.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,f.h)(Z),request:S,params:A,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({getPopupContainer:x.getPopupContainer},p),ref:T,proFieldProps:P},s),{},{children:i}))}),F=t,g=l,B=F;B.SearchSelect=g,B.displayName="ProFormComponent",E.Z=B},90672:function(z,E,e){var a=e(1413),n=e(91),u=e(85893),f=e(67294),d=e(54425),m=["fieldProps","proFieldProps"],C=function(v,t){var l=v.fieldProps,F=v.proFieldProps,g=(0,n.Z)(v,m);return(0,u.jsx)(d.Z,(0,a.Z)({ref:t,valueType:"textarea",fieldProps:l,proFieldProps:F},g))};E.Z=f.forwardRef(C)},10523:function(z,E,e){e.r(E),e.d(E,{default:function(){return S}});var a=e(5574),n=e.n(a),u=e(46176),f=e(50337),d=e(97269),m=e(24739),C=e(64317),D=e(1413),v=e(91),t=e(85893),l=e(67294),F=e(54425),g=["fieldProps","min","proFieldProps","max"],B=function(s,p){var x=s.fieldProps,O=s.min,U=s.proFieldProps,R=s.max,I=(0,v.Z)(s,g);return(0,t.jsx)(F.Z,(0,D.Z)({valueType:"digit",fieldProps:(0,D.Z)({min:O,max:R},x),ref:p,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:U},I))},r=l.forwardRef(B),T=e(90672),j=e(70044),i=e(35312),A=e(48726),P=e(71577),c=A.Z.Title,Z=function(){var s=(0,l.useState)(!0),p=n()(s,2),x=p[0],O=p[1],U=(0,l.useState)(!1),R=n()(U,2),I=R[0],K=R[1],G=(0,l.useState)({}),Q=n()(G,2),b=Q[0],H=Q[1],N=(0,l.useRef)(),$=(0,l.useRef)(),V=(0,i.useParams)();(0,l.useEffect)(function(){var y=setInterval(function(){(0,i.request)("".concat(u.T5,"/log/").concat(V.id),{headers:{access_token:u.LA}}).then(function(o){if(o.log&&o.log.status==="complete"){var h;console.log("here"),clearInterval(y),K(!1),(h=$.current)===null||h===void 0||h.reload()}else K(!0)}).catch(function(o){console.error("Error fetching job status:",o)})},5e3);return function(){return clearInterval(y)}},[I]);var J=[{title:"\u7528\u6237\u8F93\u5165",dataIndex:"q",valueType:"text"},{title:"\u6A21\u578B\u8F93\u51FA",dataIndex:"result",valueType:"text"},{title:"\u771F\u503C\u9884\u671F\u7ED3\u679C",dataIndex:"a",valueType:"text"},{title:"\u6A21\u578B\u8BC4\u6D4B\u7ED3\u679C",dataIndex:"accuracy",valueEnum:{0:"\u5426",1:"\u662F"}},{title:"\u6A21\u578B\u53EC\u56DE\u7ED3\u679C",dataIndex:"recall",valueEnum:{0:"\u5426",1:"\u662F"}}],X=function(){var o,h,L=(o=N.current)===null||o===void 0||(h=o.getFieldsFormatValue)===null||h===void 0?void 0:h.call(o);console.log(L);var W=new FormData;W.append("prompt",L.prompt),W.append("model",L.model),W.append("temperature",L.temperature),(0,i.request)("".concat(u.T5,"/start/").concat(V.id),{headers:{access_token:u.LA},method:"post",data:W}).then(function(){K(!0)})};return(0,t.jsxs)(f._z,{children:[(0,t.jsxs)(d.A,{formRef:N,layout:"horizontal",submitter:!1,initialValues:{model:"gpt-3.5-turbo",prompt:"system\u4F60\u73B0\u5728\u626E\u6F14\u4E00\u4E2A\u6587\u672C\u5206\u7C7B\u5668\uFF0C\u4F60\u9700\u8981\u533A\u5206\u6211\u7684\u95EE\u9898\u5C5E\u4E8E\u8FD9\u4E9B\u5206\u7C7B\u4E2D\u7684\u54EA\u4E2A:[\u4E70\u673A\u7968,\u9000\u706B\u8F66\u7968,\u4FEE\u6539\u9152\u5E97\u65F6\u95F4]",temperature:.8},children:[(0,t.jsx)(c,{level:5,children:"\u88AB\u8C03\u8BD5\u6570\u636E\u96C6: "}),(0,t.jsxs)(m.UW,{title:"\u63D0\u793A\u8BCD\u8C03\u8BD5\u548C\u8BC4\u6D4B",children:[(0,t.jsx)(C.Z,{name:"model",width:"md",label:"\u88AB\u8C03\u8BD5\u6A21\u578B",valueEnum:{"gpt-3.5-turbo-0301":"gpt-3.5-turbo-0301","gpt-3.5-turbo":"gpt-3.5-turbo","glm-6B":"glm-6B"}}),(0,t.jsx)(r,{label:"\u6A21\u578BTemperature",name:"temperature",fieldProps:{precision:1}})]}),(0,t.jsxs)(m.UW,{children:[(0,t.jsx)(T.Z,{name:"prompt",width:"md",label:"Prompt\u7F16\u8F91\u5668",placeholder:"\u591A\u884C\u8F93\u5165"}),(0,t.jsx)(P.ZP,{onClick:X,children:"\u6279\u91CF\u8FD0\u884C\u8C03\u8BD5\u6570\u636E\u96C6"}),(0,t.jsx)(P.ZP,{children:"\u4FDD\u5B58\u6A21\u578B+Prompt\u63D0\u793A\u8BCD"})]})]}),(0,t.jsx)(c,{level:3,children:"\u6240\u6709Query\u548C\u7ED3\u679C\u7684\u67E5\u770B"}),I?(0,t.jsx)(c,{level:5,children:"\u8FD0\u884C\u4E2D"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:["\u8FD0\u884C\u6210\u529Fquery\u6570\u91CF: ",b.count]}),(0,t.jsxs)("div",{children:["\u51C6\u786E\u7387: ",b.accuracy_rate*100,"%"]}),(0,t.jsxs)("div",{children:["\u53EC\u56DE\u7387: ",b.recall_rate*100,"%"]})]}),(0,t.jsx)(c,{level:3,children:"\u6240\u6709Query\u548C\u7ED3\u679C\u7684\u67E5\u770B"}),(0,t.jsx)(j.Z,{headerTitle:"\u4EFB\u52A1\u5217\u8868",actionRef:$,search:!1,toolBarRender:function(){return[(0,t.jsx)(P.ZP,{type:"primary",onClick:function(){handleModalOpen(!0)},children:"\u53BB\u6807\u6CE8"},"primary")]},request:function(){return O(!0),(0,i.request)("".concat(u.T5,"/log/").concat(V.id),{headers:{access_token:u.LA}}).then(function(o){return console.log(o),o.msg==="not ready"?{data:[],total:0,success:!0}:(O(!1),H({count:o.count,accuracy_rate:o.accuracy_rate,recall_rate:o.recall_rate}),{data:o.csv_data,total:o.csv_data.length,success:!0})})},columns:J})]})},S=Z}}]);
